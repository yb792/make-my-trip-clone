{"ast":null,"code":"const jwt = require('jsonwebtoken');\nconst adminAuth = (req, res, next) => {\n  var _req$header;\n  const token = (_req$header = req.header('Authorization')) === null || _req$header === void 0 ? void 0 : _req$header.split(' ')[1];\n  if (!token) return res.status(401).json({\n    message: 'Unauthorized - No token provided'\n  });\n  try {\n    const decoded = jwt.verify(token, process.env.JWT_SECRET);\n    if (!decoded.isAdmin) {\n      return res.status(403).json({\n        message: 'Forbidden - Admins only'\n      });\n    }\n    req.admin = decoded;\n    next();\n  } catch (err) {\n    res.status(403).json({\n      message: 'Forbidden - Invalid or expired token'\n    });\n  }\n};\nmodule.exports = adminAuth;","map":{"version":3,"names":["jwt","require","adminAuth","req","res","next","_req$header","token","header","split","status","json","message","decoded","verify","process","env","JWT_SECRET","isAdmin","admin","err","module","exports"],"sources":["C:/Users/HP/Desktop/Project/Make_My_Trip_Clone_Website/make-my-trip-clone/client/src/pages/ManageFlights.js"],"sourcesContent":["const jwt = require('jsonwebtoken');\r\n\r\nconst adminAuth = (req, res, next) => {\r\n  const token = req.header('Authorization')?.split(' ')[1];\r\n  if (!token) return res.status(401).json({ message: 'Unauthorized - No token provided' });\r\n\r\n  try {\r\n    const decoded = jwt.verify(token, process.env.JWT_SECRET);\r\n    if (!decoded.isAdmin) {\r\n      return res.status(403).json({ message: 'Forbidden - Admins only' });\r\n    }\r\n    req.admin = decoded;\r\n    next();\r\n  } catch (err) {\r\n    res.status(403).json({ message: 'Forbidden - Invalid or expired token' });\r\n  }\r\n};\r\n\r\nmodule.exports = adminAuth;\r\n"],"mappings":"AAAA,MAAMA,GAAG,GAAGC,OAAO,CAAC,cAAc,CAAC;AAEnC,MAAMC,SAAS,GAAGA,CAACC,GAAG,EAAEC,GAAG,EAAEC,IAAI,KAAK;EAAA,IAAAC,WAAA;EACpC,MAAMC,KAAK,IAAAD,WAAA,GAAGH,GAAG,CAACK,MAAM,CAAC,eAAe,CAAC,cAAAF,WAAA,uBAA3BA,WAAA,CAA6BG,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;EACxD,IAAI,CAACF,KAAK,EAAE,OAAOH,GAAG,CAACM,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;IAAEC,OAAO,EAAE;EAAmC,CAAC,CAAC;EAExF,IAAI;IACF,MAAMC,OAAO,GAAGb,GAAG,CAACc,MAAM,CAACP,KAAK,EAAEQ,OAAO,CAACC,GAAG,CAACC,UAAU,CAAC;IACzD,IAAI,CAACJ,OAAO,CAACK,OAAO,EAAE;MACpB,OAAOd,GAAG,CAACM,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;QAAEC,OAAO,EAAE;MAA0B,CAAC,CAAC;IACrE;IACAT,GAAG,CAACgB,KAAK,GAAGN,OAAO;IACnBR,IAAI,CAAC,CAAC;EACR,CAAC,CAAC,OAAOe,GAAG,EAAE;IACZhB,GAAG,CAACM,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;MAAEC,OAAO,EAAE;IAAuC,CAAC,CAAC;EAC3E;AACF,CAAC;AAEDS,MAAM,CAACC,OAAO,GAAGpB,SAAS","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}